<?xml version="1.0" encoding="UTF-8"?>
<parallelModel>
    <!-- 模型标识，若标识名为XXX，则模型应命名为XXX.jar，本文件命名为XXX.xml-->
    <!-- jar 包命名规范：首字母大写，多词组合时不需要连接符每个单词都大写-->
    <artifactId>BKmeans</artifactId>
    <!-- 模型名称 -->
    <name>基于二分Kmeans的层次聚类</name>
    <!-- 模型描述 -->
    <description>输入数据的格式为TXT格式，输入文件根目录为点数据根目录，基于二分Kmeans算法计算各点数据属于的类别</description>
    <!-- 算法描述 -->
    <algo>
        二分Kmeans算法属于自顶而下的层次聚类方法,
    </algo>
    <!-- 模型适用类型（按照工具箱分类设置属性，单选项）-->
    <usage>spatialclustering</usage>
    <!-- 主类 -->
    <mainClass>com.igsnrr.toolbox.spatialclustering.bitsectingkmeans.BKmeans</mainClass>
    <!--分布式计算框架类型 spark，hadoop可选-->
    <frameworkType>spark</frameworkType>
    <!-- 模型开发日期-->
    <date>201807010</date>
    <!-- 版本号 -->
    <versionId>1.0</versionId>
    <!-- 关键字，以";"-->
    <keyWords>二分Kmeans;层次聚类</keyWords>
    <!-- 联系单位-->
    <groupId>中科院地理所</groupId>
    <!-- 模型负责人-->
    <authorId>王席</authorId>
    <!-- email地址-->
    <email>wangxi@lreis.ac.cn</email>


    <!-- 输入数据规范，支持从多个地方输入数据，设置不同的data标签，自定义data标签名称 -->
    <in>
        <data name="hdfs">
            <!-- 输入数据存储方式，可选（hdfs，mysql，file，redis） -->
            <path>hdfs</path>
            <!-- 输入数据格式，可选（txt，wkt）-->
            <type>txt</type>
            <!-- 输入数据字段信息 -->
            <fields>
                <property name="x1" datatype="Double" default="" description="一维点坐标" required="true"></property>
                <property name="x2" datatype="Double" default="" description="二维点坐标" required="true"></property>
            </fields>
        </data>
        <data name="hdfs">
            <!-- 输入数据存储方式，可选（hdfs，mysql，file，redis） -->
            <path>hdfs</path>
            <!-- 输入数据格式，可选（txt，wkt）-->
            <type>txt</type>
            <!-- 输入数据字段信息 -->
            <fields>
                <property name="x1" datatype="Double" default="" description="一维点坐标" required="true"></property>
                <property name="x2" datatype="Double" default="" description="二维点坐标" required="true"></property>
            </fields>
        </data>
    </in>
    <!-- 输出数据规范，支持多个地方输出数据，设置不同的data标签 -->
    <out>
        <data name="file">
            <!-- 输出数据存储方式，可选（hdfs,mysql,file,redis,rdd） -->
            <path>file</path>
            <!-- 输出数据格式，可选（txt,wkt,tuple（专属rdd））-->
            <type>txt</type>
            <!-- 输出数据字段信息 -->
            <fields>
                <property name="ClusterID" datatype="String" default="" description="点所属类别" required="true"></property>
                <property name="CenterX" datatype="Array[Double]" default="" description="聚类中心"
                          required="true"></property>
                <property name="Point" datatype="Array[Double]" default="" description="点对象值"
                          required="true"></property>
                <property name="nnDist" datatype="Double" default="" description="点到聚类中心的距离" required="true"></property>
            </fields>
        </data>
    </out>
    <!-- 参数列表： 参数名称，参数数据类型，默认值，参数描述 -->
    <parameters>
        <property name="任务名称" datatype="String" default="default" description="一个SPARK任务的名称"/>
        <property name="输入点数据" datatype="String" default="default" description="详见input描述"/>
        <property name="输出聚类中心文件" datatype="String" default="default" description="详见output描述"/>
        <property name="聚类类别个数" datatype="Integer" default="3" description="结果中聚类类别的个数"/>
        <property name="最大迭代次数" datatype="Integer" default="20" description="计算聚类中心时迭代次数的最大值"/>
        <property name="每个类中的最小个数" datatype="Integer" default="0.5" description="最终聚类结果中各个类中点的最小个数"/>
    </parameters>

    <!-- 第三方库 -->
    <packages>
        <package>
            <name></name>
            <version></version>
            <url></url>
        </package>
    </packages>

    <!-- 模型主要实现接口 对外提供的函数-->
    <interfaces>

        <interface>
            <!--接口的名称-->
            <name></name>
            <!--接口所在类-->
            <intfcClass></intfcClass>
            <!--接口功能描述-->
            <intfdesc></intfdesc>
            <!--接口的输入参数-->
            <inParams>
                <property name="" datatype="" default="" description=""/>
            </inParams>
            <!--接口的输出参数-->
            <outParams>
                <property name="" datatype="" default="" description=""/>
            </outParams>
        </interface>

        <interface>
            <name></name>
            <intfcClass></intfcClass>
            <inParams>

            </inParams>
            <outParams>

            </outParams>
        </interface>


    </interfaces>

    <!--程序测试结果 -->
    <test>
        <!--测试数据的地址路径-->
        <in>/test/data/data_3d</in>
        <!--测试数据的描述(数据维度，数据量...)，以 ";"-->
        <inDesc>三维点数据;1000000</inDesc>
        <!--输出数据的地址路径-->
        <out>/test/res/data_3d_res</out>
        <cmdline>
            ./bin/spark2-submit
            --master yarn-cluster
            --num-executors 4
            --executor-memory 2G
            --executor-cores 4
            --conf spark.default.parallelism=32
            --class com.igsnrr.toolbox.spatialclustering.bitsectingkmeans.BKmeans
            toolbox-0.0.1.jar /test/data/data_3d /test/data/data_3d_bkmeans_res
        </cmdline>
        <!--测试结果描述（与串行算法结果对比,集群运行时长...），以";"-->
        <outDesc>准确率99%;3 min</outDesc>
    </test>

</parallelModel>